$(document).on('page:change', function(){
  var maxShifts      = 59, //maximum shifts allowed
      shiftsWrapper  = $('#shifts-wrapper'), //id tag where shifts elements will be inserted
      addShift       = $('#add-shift'),
      removeShift    = $('#remove-shift'),
      shiftCount     = 0;



  function loadFirstShift(){
      shiftCount++;
      var firstShift;
      firstShift = ' <div class="shift" id="new-shift-row-'+ shiftCount +'"> <div class="row"> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-2 columns"><span class="prefix">date</span></div> <div class="large-9 medium-9 small-10 columns"><input class="date" id="timesheet_date" name="timesheet[shifts][][date]" type="date" required></div> </div> </div> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-2 columns"><span class="prefix">time</span></div> <div class="large-9 medium-9 small-10 columns"> <select class="start_time timesheet_start_time" name="timesheet[shifts][][start_time]" required> <option value="9:00am">9:00am</option> <option value="9:15am">9:15am</option> <option value="9:30am">9:30am</option> <option value="9:45am">9:45am</option> <option value="10:00am">10:00am</option> <option value="10:15am">10:15am</option> <option value="10:30am">10:30am</option> <option value="10:45am">10:45am</option> <option value="11:00am">11:00am</option> <option value="11:15am">11:15am</option> <option value="11:30am">11:30am</option> <option value="11:45am">11:45am</option> <option value="12:00pm">12:00pm</option> <option value="12:15pm">12:15pm</option> <option value="12:30pm">12:30pm</option> <option value="12:45pm">12:45pm</option> <option value="1:00pm">1:00pm</option> <option value="1:15pm">1:15pm</option> <option value="1:30pm">1:30pm</option> <option value="1:45pm">1:45pm</option> <option value="2:00pm">2:00pm</option> <option value="2:15pm">2:15pm</option> <option value="2:30pm">2:30pm</option> <option value="2:45pm">2:45pm</option> <option value="3:00pm">3:00pm</option> <option value="3:15pm">3:15pm</option> <option value="3:30pm">3:30pm</option> <option value="3:45pm">3:45pm</option> <option value="4:00pm">4:00pm</option> <option value="4:15pm">4:15pm</option> <option value="4:30pm">4:30pm</option> <option value="4:45pm">4:45pm</option> <option value="5:00pm">5:00pm</option> <option value="5:15pm">5:15pm</option> <option value="5:30pm">5:30pm</option> <option value="5:45pm">5:45pm</option> <option value="6:00pm">6:00pm</option> <option value="6:15pm">6:15pm</option> <option value="6:30pm">6:30pm</option> <option value="6:45pm">6:45pm</option> <option value="7:00pm">7:00pm</option> <option value="7:15pm">7:15pm</option> <option value="7:30pm">7:30pm</option> <option value="7:45pm">7:45pm</option> <option value="8:00pm">8:00pm</option> <option value="8:15pm">8:15pm</option> <option value="8:30pm">8:30pm</option> <option value="8:45pm">8:45pm</option> <option value="9:00pm">9:00pm</option> </select> </div> </div> </div> <div class="large-6 medium-6 small-12 columns"> <div class="position"> <select class="MH_Position" name="timesheet[shifts][][position]" required> <option value="Tour Guide">Tour Guide</option> <option value="Co-host">Co-host</option> <option value="Admin">Admin</option> <option value="Other">Other</option> </select> </div> </div> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-3 columns"><span class="prefix">$</span></div> <div class="large-9 medium-9 small-9 columns"><input class="timesheet_pay_rate rate" name="timesheet[shifts][][pay_rate]" placeholder="Pay Rate" type="text" value="32" required disabled></div> </div> </div> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-2 columns"><span class="prefix">hrs</span></div> <div class="large-9 medium-9 small-10 columns"><input class="hours" id="timesheet_hours_worked" name="timesheet[shifts][][hours_worked]" placeholder="Time On Shift" type="text" required></div> </div> </div> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-3 columns"><span class="prefix">$</span></div> <div class="large-9 medium-9 small-9 columns"><input class="subtotal" name="timesheet[shifts][][subtotal]" placeholder="Subtotal" type="text" required disabled></div> </div> </div> </div>';
      shiftsWrapper.append(firstShift);
  };



  loadFirstShift();



  $(addShift).on('click', function(ev){
    var shiftForm;
    ev.preventDefault();
    if (shiftCount <= maxShifts) {
      shiftCount++;
      shiftForm = '<div class="shift" id="new-shift-row-'+ shiftCount +'"><div class="row"> <div class="large-12 large-centered columns"> <hr> </div></div><br><div class="row"> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-2 columns"><span class="prefix">date</span></div> <div class="large-9 medium-9 small-10 columns"><input class="date" id="timesheet_date" name="timesheet[shifts][][date]" type="date" required></div> </div> </div> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-2 columns"><span class="prefix">time</span></div> <div class="large-9 medium-9 small-10 columns"> <select class="start_time timesheet_start_time" name="timesheet[shifts][][start_time]" required> <option value="9:00am">9:00am</option> <option value="9:15am">9:15am</option> <option value="9:30am">9:30am</option> <option value="9:45am">9:45am</option> <option value="10:00am">10:00am</option> <option value="10:15am">10:15am</option> <option value="10:30am">10:30am</option> <option value="10:45am">10:45am</option> <option value="11:00am">11:00am</option> <option value="11:15am">11:15am</option> <option value="11:30am">11:30am</option> <option value="11:45am">11:45am</option> <option value="12:00pm">12:00pm</option> <option value="12:15pm">12:15pm</option> <option value="12:30pm">12:30pm</option> <option value="12:45pm">12:45pm</option> <option value="1:00pm">1:00pm</option> <option value="1:15pm">1:15pm</option> <option value="1:30pm">1:30pm</option> <option value="1:45pm">1:45pm</option> <option value="2:00pm">2:00pm</option> <option value="2:15pm">2:15pm</option> <option value="2:30pm">2:30pm</option> <option value="2:45pm">2:45pm</option> <option value="3:00pm">3:00pm</option> <option value="3:15pm">3:15pm</option> <option value="3:30pm">3:30pm</option> <option value="3:45pm">3:45pm</option> <option value="4:00pm">4:00pm</option> <option value="4:15pm">4:15pm</option> <option value="4:30pm">4:30pm</option> <option value="4:45pm">4:45pm</option> <option value="5:00pm">5:00pm</option> <option value="5:15pm">5:15pm</option> <option value="5:30pm">5:30pm</option> <option value="5:45pm">5:45pm</option> <option value="6:00pm">6:00pm</option> <option value="6:15pm">6:15pm</option> <option value="6:30pm">6:30pm</option> <option value="6:45pm">6:45pm</option> <option value="7:00pm">7:00pm</option> <option value="7:15pm">7:15pm</option> <option value="7:30pm">7:30pm</option> <option value="7:45pm">7:45pm</option> <option value="8:00pm">8:00pm</option> <option value="8:15pm">8:15pm</option> <option value="8:30pm">8:30pm</option> <option value="8:45pm">8:45pm</option> <option value="9:00pm">9:00pm</option> </select> </div> </div> </div> <div class="large-6 medium-6 small-12 columns"> <select class="MH_Position" name="timesheet[shifts][][position]" required> <option value="Tour Guide">Tour Guide</option> <option value="Co-host">Co-host</option> <option value="Admin">Admin</option> <option value="Other">Other</option> </select> </div> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-3 columns"><span class="prefix">$</span></div> <div class="large-9 medium-9 small-9 columns"><input class="timesheet_pay_rate rate" name="timesheet[shifts][][pay_rate]" placeholder="Pay Rate" type="text" value="32" required disabled></div> </div> </div> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-2 columns"><span class="prefix">hrs</span></div> <div class="large-9 medium-9 small-10 columns"><input class="hours" id="timesheet_hours_worked" name="timesheet[shifts][][hours_worked]" placeholder="Time On Shift" type="text" required></div> </div> </div> <div class="large-6 medium-6 small-12 columns"> <div class="row collapse"> <div class="large-3 medium-3 small-3 columns"><span class="prefix">$</span></div> <div class="large-9 medium-9 small-9 columns"><input class="subtotal" name="timesheet[shifts][][subtotal]" placeholder="Subtotal" type="text" required disabled></div> </div> </div></div>';
      shiftsWrapper.append(shiftForm);
    }
  });

  $(removeShift).on('click', function(ev){
    ev.preventDefault();
    if ( shiftCount > 1) {
      $('div[id="new-shift-row-'+ shiftCount +'"]').remove();
      shiftCount--;
    }
  });
});
